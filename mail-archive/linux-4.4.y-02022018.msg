
-----------------------------
Stable Kernel Security Notice
2018-02-02

Stable Branch: linux-4.4.y

All linux-4.4.y CVEs:
http://joshuahunt.github.io/cve-tracker/linux-4.4.y-stable-cve-list.html

CVE(s) in report:

CVE-2017-16911
CVE-2017-16912
CVE-2017-16913
CVE-2017-16914
-----------------------------

Details:

*************
CVE-2017-16911:
*************

*** This is a new CVE ***
This CVE has been resolved in 4.4.114.
Please pull this or a newer version of the kernel to resolve this security vulnerability.

---
Description of fix for this vulnerability:
commit 2f2d0088eb93db5c649d2a5e34a3800a8a935fc5
Author: Shuah Khan <shuahkh@osg.samsung.com>
Date:   Thu Dec 7 14:16:49 2017 -0700

    usbip: prevent vhci_hcd driver from leaking a socket pointer address
    
    When a client has a USB device attached over IP, the vhci_hcd driver is
    locally leaking a socket pointer address via the
    
    /sys/devices/platform/vhci_hcd/status file (world-readable) and in debug
    output when "usbip --debug port" is run.
    
    Fix it to not leak. The socket pointer address is not used at the moment
    and it was made visible as a convenient way to find IP address from socket
    pointer address by looking up /proc/net/{tcp,tcp6}.
    
    As this opens a security hole, the fix replaces socket pointer address with
    sockfd.
    
    Reported-by: Secunia Research <vuln@secunia.com>
    Cc: stable <stable@vger.kernel.org>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

 drivers/usb/usbip/usbip_common.h     |  1 +
 drivers/usb/usbip/vhci_sysfs.c       | 25 ++++++++++++++++---------
 tools/usb/usbip/libsrc/vhci_driver.c |  8 ++++----
 3 files changed, 21 insertions(+), 13 deletions(-)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2018-01-31
CVE: CVE-2017-16911
Break Date: -
Break Commit: -
Break Tag: -
Linus Fix Date: 2017-12-08
Linus Commit: 2f2d0088eb93db5c649d2a5e34a3800a8a935fc5
Linus Tag: 4.15-rc4
Stable Date: 2018-01-31
Stable Commit: 28f467e0bdda754aa36390fd90b01823f0d3b18d
Stable Tag: 4.4.114

CVE-2017-16912:
*************

*** This is a new CVE ***
This CVE has been resolved in 4.4.114.
Please pull this or a newer version of the kernel to resolve this security vulnerability.

---
Description of fix for this vulnerability:
commit 635f545a7e8be7596b9b2b6a43cab6bbd5a88e43
Author: Shuah Khan <shuahkh@osg.samsung.com>
Date:   Thu Dec 7 14:16:47 2017 -0700

    usbip: fix stub_rx: get_pipe() to validate endpoint number
    
    get_pipe() routine doesn't validate the input endpoint number
    and uses to reference ep_in and ep_out arrays. Invalid endpoint
    number can trigger BUG(). Range check the epnum and returning
    error instead of calling BUG().
    
    Change caller stub_recv_cmd_submit() to handle the get_pipe()
    error return.
    
    Reported-by: Secunia Research <vuln@secunia.com>
    Cc: stable <stable@vger.kernel.org>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

 drivers/usb/usbip/stub_rx.c | 18 +++++++++++-------
 1 file changed, 11 insertions(+), 7 deletions(-)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2018-01-31
CVE: CVE-2017-16912
Break Date: -
Break Commit: -
Break Tag: -
Linus Fix Date: 2017-12-08
Linus Commit: 635f545a7e8be7596b9b2b6a43cab6bbd5a88e43
Linus Tag: 4.15-rc4
Stable Date: 2018-01-31
Stable Commit: 80e733a9b37fb6b40351bf1924d5a90d89c375ae
Stable Tag: 4.4.114

CVE-2017-16913:
*************

*** This is a new CVE ***
This CVE has been resolved in 4.4.114.
Please pull this or a newer version of the kernel to resolve this security vulnerability.

---
Description of fix for this vulnerability:
commit c6688ef9f29762e65bce325ef4acd6c675806366
Author: Shuah Khan <shuahkh@osg.samsung.com>
Date:   Thu Dec 7 14:16:48 2017 -0700

    usbip: fix stub_rx: harden CMD_SUBMIT path to handle malicious input
    
    Harden CMD_SUBMIT path to handle malicious input that could trigger
    large memory allocations. Add checks to validate transfer_buffer_length
    and number_of_packets to protect against bad input requesting for
    unbounded memory allocations. Validate early in get_pipe() and return
    failure.
    
    Reported-by: Secunia Research <vuln@secunia.com>
    Cc: stable <stable@vger.kernel.org>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

 drivers/usb/usbip/stub_rx.c | 35 +++++++++++++++++++++++++++++++----
 1 file changed, 31 insertions(+), 4 deletions(-)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2018-01-31
CVE: CVE-2017-16913
Break Date: -
Break Commit: -
Break Tag: -
Linus Fix Date: 2017-12-08
Linus Commit: c6688ef9f29762e65bce325ef4acd6c675806366
Linus Tag: 4.15-rc4
Stable Date: 2018-01-31
Stable Commit: b6f826ba10dce86f74efd3c0953cb9982a3c51e2
Stable Tag: 4.4.114

CVE-2017-16914:
*************

*** This is a new CVE ***
This CVE has been resolved in 4.4.107.
Please pull this or a newer version of the kernel to resolve this security vulnerability.

---
Description of fix for this vulnerability:
commit be6123df1ea8f01ee2f896a16c2b7be3e4557a5a
Author: Shuah Khan <shuahkh@osg.samsung.com>
Date:   Thu Dec 7 14:16:50 2017 -0700

    usbip: fix stub_send_ret_submit() vulnerability to null transfer_buffer
    
    stub_send_ret_submit() handles urb with a potential null transfer_buffer,
    when it replays a packet with potential malicious data that could contain
    a null buffer. Add a check for the condition when actual_length > 0 and
    transfer_buffer is null.
    
    Reported-by: Secunia Research <vuln@secunia.com>
    Cc: stable <stable@vger.kernel.org>
    Signed-off-by: Shuah Khan <shuahkh@osg.samsung.com>
    Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

 drivers/usb/usbip/stub_tx.c | 7 +++++++
 1 file changed, 7 insertions(+)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2018-01-31
CVE: CVE-2017-16914
Break Date: -
Break Commit: -
Break Tag: -
Linus Fix Date: 2017-12-08
Linus Commit: be6123df1ea8f01ee2f896a16c2b7be3e4557a5a
Linus Tag: 4.15-rc4
Stable Date: 2017-12-20
Stable Commit: 2862cfca39894ac265fbb5cde9a3ff90c02201f3
Stable Tag: 4.4.107
