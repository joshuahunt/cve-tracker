
-----------------------------
Stable Kernel Security Notice
2017-09-28

Stable Branch: linux-4.9.y

All linux-4.9.y CVEs:
http://joshuahunt.github.io/cve-tracker/linux-4.9.y-stable-cve-list.html

CVE(s) in report:

CVE-2017-1000252
CVE-2017-1000252
CVE-2017-12154
-----------------------------

Details:

*************
CVE-2017-1000252:
*************

---
Description of fix for this vulnerability:
commit 36ae3c0a36b7456432fedce38ae2f7bd3e01a563
Author: Jan H. Schönherr <jschoenh@amazon.de>
Date:   Thu Sep 7 19:02:48 2017 +0100

    KVM: Don't accept obviously wrong gsi values via KVM_IRQFD
    
    We cannot add routes for gsi values >= KVM_MAX_IRQ_ROUTES -- see
    kvm_set_irq_routing(). Hence, there is no sense in accepting them
    via KVM_IRQFD. Prevent them from entering the system in the first
    place.
    
    Signed-off-by: Jan H. Schönherr <jschoenh@amazon.de>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

 virt/kvm/eventfd.c | 2 ++
 1 file changed, 2 insertions(+)
---
The following fields have changed: Public Date
Public Date: 2017-09-15 -> 2017-09-26

CVE-2017-1000252:
*************

---
Description of fix for this vulnerability:
commit 3a8b0677fc6180a467e26cc32ce6b0c09a32f9bb
Author: Jan H. Schönherr <jschoenh@amazon.de>
Date:   Thu Sep 7 19:02:30 2017 +0100

    KVM: VMX: Do not BUG() on out-of-bounds guest IRQ
    
    The value of the guest_irq argument to vmx_update_pi_irte() is
    ultimately coming from a KVM_IRQFD API call. Do not BUG() in
    vmx_update_pi_irte() if the value is out-of bounds. (Especially,
    since KVM as a whole seems to hang after that.)
    
    Instead, print a message only once if we find that we don't have a
    route for a certain IRQ (which can be out-of-bounds or within the
    array).
    
    This fixes CVE-2017-1000252.
    
    Fixes: efc644048ecde54 ("KVM: x86: Update IRTE for posted-interrupts")
    Signed-off-by: Jan H. Schönherr <jschoenh@amazon.de>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

 arch/x86/kvm/vmx.c | 9 +++++++--
 1 file changed, 7 insertions(+), 2 deletions(-)
---
The following fields have changed: Public Date
Public Date: 2017-09-15 -> 2017-09-26

CVE-2017-12154:
*************

---
Description of fix for this vulnerability:
commit 51aa68e7d57e3217192d88ce90fd5b8ef29ec94f
Author: Jim Mattson <jmattson@google.com>
Date:   Tue Sep 12 13:02:54 2017 -0700

    kvm: nVMX: Don't allow L2 to access the hardware CR8
    
    If L1 does not specify the "use TPR shadow" VM-execution control in
    vmcs12, then L0 must specify the "CR8-load exiting" and "CR8-store
    exiting" VM-execution controls in vmcs02. Failure to do so will give
    the L2 VM unrestricted read/write access to the hardware CR8.
    
    This fixes CVE-2017-12154.
    
    Signed-off-by: Jim Mattson <jmattson@google.com>
    Reviewed-by: David Hildenbrand <david@redhat.com>
    Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

 arch/x86/kvm/vmx.c | 5 +++++
 1 file changed, 5 insertions(+)
---
The following fields have changed: Public Date
Public Date: 2017-09-14 -> 2017-09-26
