
-----------------------------
Stable Kernel Security Notice
2017-05-19

Stable Branch: linux-4.1.y

All linux-4.1.y CVEs:
http://joshuahunt.github.io/cve-tracker/linux-4.1.y-stable-cve-list.html

CVE(s) in report:

CVE-2017-5576
CVE-2017-5577
CVE-2017-8071
-----------------------------

Details:

*************
CVE-2017-5576:
*************

*** This is a new CVE ***
---
Description of fix for this vulnerability:
commit 0f2ff82e11c86c05d051cae32b58226392d33bbf
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Jan 17 21:42:53 2017 +1100

    drm/vc4: Fix an integer overflow in temporary allocation layout.
    
    We copy the unvalidated ioctl arguments from the user into kernel
    temporary memory to run the validation from, to avoid a race where the
    user updates the unvalidate contents in between validating them and
    copying them into the validated BO.
    
    However, in setting up the layout of the kernel side, we failed to
    check one of the additions (the roundup() for shader_rec_offset)
    against integer overflow, allowing a nearly MAX_UINT value of
    bin_cl_size to cause us to under-allocate the temporary space that we
    then copy_from_user into.
    
    Reported-by: Murray McAllister <murray.mcallister@insomniasec.com>
    Signed-off-by: Eric Anholt <eric@anholt.net>
    Fixes: d5b1a78a772f ("drm/vc4: Add support for drawing 3D frames.")

 drivers/gpu/drm/vc4/vc4_gem.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2017-02-06
CVE: CVE-2017-5576
Break Date: 2015-12-07
Break Commit: d5b1a78a772f1e31a94f8babfa964152ec5e9aa5
Break Tag: 4.5
Linus Fix Date: 2017-01-17
Linus Commit: 0f2ff82e11c86c05d051cae32b58226392d33bbf
Linus Tag: 4.10
Stable Date: -
Stable Commit: -
Stable Tag: -

CVE-2017-5577:
*************

*** This is a new CVE ***
---
Description of fix for this vulnerability:
commit 6b8ac63847bc2f958dd93c09edc941a0118992d9
Author: Eric Anholt <eric@anholt.net>
Date:   Tue Jan 17 21:58:06 2017 +1100

    drm/vc4: Return -EINVAL on the overflow checks failing.
    
    By failing to set the errno, we'd continue on to trying to set up the
    RCL, and then oops on trying to dereference the tile_bo that binning
    validation should have set up.
    
    Reported-by: Ingo Molnar <mingo@kernel.org>
    Signed-off-by: Eric Anholt <eric@anholt.net>
    Fixes: d5b1a78a772f ("drm/vc4: Add support for drawing 3D frames.")

 drivers/gpu/drm/vc4/vc4_gem.c | 1 +
 1 file changed, 1 insertion(+)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2017-02-06
CVE: CVE-2017-5577
Break Date: 2015-12-07
Break Commit: d5b1a78a772f1e31a94f8babfa964152ec5e9aa5
Break Tag: 4.5
Linus Fix Date: 2017-01-17
Linus Commit: 6b8ac63847bc2f958dd93c09edc941a0118992d9
Linus Tag: 4.10
Stable Date: -
Stable Commit: -
Stable Tag: -

CVE-2017-8071:
*************

---
Description of fix for this vulnerability:
commit 7a7b5df84b6b4e5d599c7289526eed96541a0654
Author: Johan Hovold <johan@kernel.org>
Date:   Mon Jan 30 11:26:38 2017 +0100

    HID: cp2112: fix sleep-while-atomic
    
    A recent commit fixing DMA-buffers on stack added a shared transfer
    buffer protected by a spinlock. This is broken as the USB HID request
    callbacks can sleep. Fix this up by replacing the spinlock with a mutex.
    
    Fixes: 1ffb3c40ffb5 ("HID: cp2112: make transfer buffers DMA capable")
    Cc: stable <stable@vger.kernel.org>	# 4.9
    Signed-off-by: Johan Hovold <johan@kernel.org>
    Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>
    Signed-off-by: Jiri Kosina <jkosina@suse.cz>

 drivers/hid/hid-cp2112.c | 26 +++++++++++---------------
 1 file changed, 11 insertions(+), 15 deletions(-)
---
The following fields have changed: Break Date,Break Commit,Break Tag
Break Date: - -> 2016-11-23
Break Commit: - -> 1ffb3c40ffb5c51bc39736409b11816c4260218e
Break Tag: - -> 4.9
