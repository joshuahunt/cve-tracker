
-----------------------------
Stable Kernel Security Notice
2017-07-26

Stable Branch: linux-4.1.y

All linux-4.1.y CVEs:
http://joshuahunt.github.io/cve-tracker/linux-4.1.y-stable-cve-list.html

CVE(s) in report:

CVE-2017-7541
-----------------------------

Details:

*************
CVE-2017-7541:
*************

*** This is a new CVE ***
---
Description of fix for this vulnerability:
commit 8f44c9a41386729fea410e688959ddaa9d51be7c
Author: Arend van Spriel <arend.vanspriel@broadcom.com>
Date:   Fri Jul 7 21:09:06 2017 +0100

    brcmfmac: fix possible buffer overflow in brcmf_cfg80211_mgmt_tx()
    
    The lower level nl80211 code in cfg80211 ensures that "len" is between
    25 and NL80211_ATTR_FRAME (2304).  We subtract DOT11_MGMT_HDR_LEN (24) from
    "len" so thats's max of 2280.  However, the action_frame->data[] buffer is
    only BRCMF_FIL_ACTION_FRAME_SIZE (1800) bytes long so this memcpy() can
    overflow.
    
    	memcpy(action_frame->data, &buf[DOT11_MGMT_HDR_LEN],
    	       le16_to_cpu(action_frame->len));
    
    Cc: stable@vger.kernel.org # 3.9.x
    Fixes: 18e2f61db3b70 ("brcmfmac: P2P action frame tx.")
    Reported-by: "freenerguo(郭大兴)" <freenerguo@tencent.com>
    Signed-off-by: Arend van Spriel <arend.vanspriel@broadcom.com>
    Signed-off-by: David S. Miller <davem@davemloft.net>

 drivers/net/wireless/broadcom/brcm80211/brcmfmac/cfg80211.c | 5 +++++
 1 file changed, 5 insertions(+)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2017-07-25
CVE: CVE-2017-7541
Break Date: 2013-02-08
Break Commit: 18e2f61db3b708e0a22ccc403cb6ab2203d6faab
Break Tag: 3.9
Linus Fix Date: 2017-07-12
Linus Commit: 8f44c9a41386729fea410e688959ddaa9d51be7c
Linus Tag: 4.13
Stable Date: -
Stable Commit: -
Stable Tag: -
