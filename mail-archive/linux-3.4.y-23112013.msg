
-----------------------------
Stable Kernel Security Notice
2013-11-23

Stable Branch: linux-3.4.y

All linux-3.4.y CVEs:
http://joshuahunt.github.io/cve-tracker/linux-3.4.y-stable-cve-list.html

CVE(s) in report:

CVE-2013-4563
CVE-2013-4591
CVE-2013-4592
CVE-2013-4592
CVE-2013-6282
-----------------------------

Details:

*************
CVE-2013-4563:
*************

*** This is a new CVE ***
---
Description of fix for this vulnerability:
commit 0e033e04c2678dbbe74a46b23fffb7bb918c288e
Author: Hannes Frederic Sowa <hannes@stressinduktion.org>
Date:   Tue Nov 5 02:41:27 2013 +0100

    ipv6: fix headroom calculation in udp6_ufo_fragment
    
    Commit 1e2bd517c108816220f262d7954b697af03b5f9c ("udp6: Fix udp
    fragmentation for tunnel traffic.") changed the calculation if
    there is enough space to include a fragment header in the skb from a
    skb->mac_header dervived one to skb_headroom. Because we already peeled
    off the skb to transport_header this is wrong. Change this back to check
    if we have enough room before the mac_header.
    
    This fixes a panic Saran Neti reported. He used the tbf scheduler which
    skb_gso_segments the skb. The offsets get negative and we panic in memcpy
    because the skb was erroneously not expanded at the head.
    
    Reported-by: Saran Neti <Saran.Neti@telus.com>
    Cc: Pravin B Shelar <pshelar@nicira.com>
    Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>
    Signed-off-by: David S. Miller <davem@davemloft.net>

 net/ipv6/udp_offload.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2013-11-20
CVE: CVE-2013-4563
Break Date: 2013-05-31
Break Commit: 1e2bd517c108816220f262d7954b697af03b5f9c
Break Tag: 3.10
Linus Fix Date: 2013-11-05
Linus Commit: 0e033e04c2678dbbe74a46b23fffb7bb918c288e
Linus Tag: 3.13
Stable Date: -
Stable Commit: -
Stable Tag: -

CVE-2013-4591:
*************

*** This is a new CVE ***
---
Description of fix for this vulnerability:
commit 7d3e91a89b7adbc2831334def9e494dd9892f9af
Author: Sven Wegener <sven.wegener@stealer.net>
Date:   Sat Dec 8 15:30:18 2012 +0100

    NFSv4: Check for buffer length in __nfs4_get_acl_uncached
    
    Commit 1f1ea6c "NFSv4: Fix buffer overflow checking in
    __nfs4_get_acl_uncached" accidently dropped the checking for too small
    result buffer length.
    
    If someone uses getxattr on "system.nfs4_acl" on an NFSv4 mount
    supporting ACLs, the ACL has not been cached and the buffer suplied is
    too short, we still copy the complete ACL, resulting in kernel and user
    space memory corruption.
    
    Signed-off-by: Sven Wegener <sven.wegener@stealer.net>
    Cc: stable@kernel.org
    Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>

 fs/nfs/nfs4proc.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2013-11-20
CVE: CVE-2013-4591
Break Date: -
Break Commit: -
Break Tag: -
Linus Fix Date: 2012-12-11
Linus Commit: 7d3e91a89b7adbc2831334def9e494dd9892f9af
Linus Tag: 3.8
Stable Date: -
Stable Commit: -
Stable Tag: -

CVE-2013-4592:
*************

*** This is a new CVE ***
---
Description of fix for this vulnerability:
commit 12d6e7538e2d418c08f082b1b44ffa5fb7270ed8
Author: Marcelo Tosatti <mtosatti@redhat.com>
Date:   Fri Aug 24 15:54:58 2012 -0300

    KVM: perform an invalid memslot step for gpa base change
    
    PPC must flush all translations before the new memory slot
    is visible.
    
    Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
    Signed-off-by: Avi Kivity <avi@redhat.com>

 virt/kvm/kvm_main.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2013-11-20
CVE: CVE-2013-4592
Break Date: -
Break Commit: -
Break Tag: -
Linus Fix Date: 2012-09-06
Linus Commit: 12d6e7538e2d418c08f082b1b44ffa5fb7270ed8
Linus Tag: 3.7
Stable Date: -
Stable Commit: -
Stable Tag: -

CVE-2013-4592:
*************

*** This is a new CVE ***
---
Description of fix for this vulnerability:
commit e40f193f5bb022e927a57a4f5d5194e4f12ddb74
Author: Alex Williamson <alex.williamson@redhat.com>
Date:   Mon Dec 10 10:32:57 2012 -0700

    KVM: Fix iommu map/unmap to handle memory slot moves
    
    The iommu integration into memory slots expects memory slots to be
    added or removed and doesn't handle the move case.  We can unmap
    slots from the iommu after we mark them invalid and map them before
    installing the final memslot array.  Also re-order the kmemdup vs
    map so we don't leave iommu mappings if we get ENOMEM.
    
    Reviewed-by: Gleb Natapov <gleb@redhat.com>
    Signed-off-by: Alex Williamson <alex.williamson@redhat.com>
    Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>

 virt/kvm/kvm_main.c | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2013-11-20
CVE: CVE-2013-4592
Break Date: -
Break Commit: -
Break Tag: -
Linus Fix Date: 2012-12-13
Linus Commit: e40f193f5bb022e927a57a4f5d5194e4f12ddb74
Linus Tag: 3.9
Stable Date: -
Stable Commit: -
Stable Tag: -

CVE-2013-6282:
*************

*** This is a new CVE ***
This CVE has been resolved in 3.4.12.
Please pull this or a newer version of the kernel to resolve this security vulnerability.

---
Description of fix for this vulnerability:
commit 8404663f81d212918ff85f493649a7991209fa04
Author: Russell King <rmk+kernel@arm.linux.org.uk>
Date:   Fri Sep 7 18:22:28 2012 +0100

    ARM: 7527/1: uaccess: explicitly check __user pointer when !CPU_USE_DOMAINS
    
    The {get,put}_user macros don't perform range checking on the provided
    __user address when !CPU_HAS_DOMAINS.
    
    This patch reworks the out-of-line assembly accessors to check the user
    address against a specified limit, returning -EFAULT if is is out of
    range.
    
    [will: changed get_user register allocation to match put_user]
    [rmk: fixed building on older ARM architectures]
    
    Reported-by: Catalin Marinas <catalin.marinas@arm.com>
    Signed-off-by: Will Deacon <will.deacon@arm.com>
    Cc: stable@vger.kernel.org
    Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

 arch/arm/include/asm/assembler.h |  8 ++++++++
 arch/arm/include/asm/uaccess.h   | 40 +++++++++++++++++++++++++++-------------
 arch/arm/lib/getuser.S           | 23 +++++++++++++++--------
 arch/arm/lib/putuser.S           |  6 ++++++
 4 files changed, 56 insertions(+), 21 deletions(-)
---
The following fields have changed: Public Date,CVE,Break Date,Break Commit,Break Tag,Linus Fix Date,Linus Commit,Linus Tag,Stable Date,Stable Commit,Stable Tag
Public Date: 2013-11-20
CVE: CVE-2013-6282
Break Date: -
Break Commit: -
Break Tag: -
Linus Fix Date: 2012-09-09
Linus Commit: 8404663f81d212918ff85f493649a7991209fa04
Linus Tag: 3.6
Stable Date: 2012-10-02
Stable Commit: 8cc876def310b034ab0e0775a14d1a49472d7f5f
Stable Tag: 3.4.12
